import{_ as s,o as n,c as a,b as i}from"./app-B6NiJo-f.js";const e={},l=i(`<div class="custom-container tip"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">TIP</p><p>项目环境: vue-cli 创建的基于 webpack 的 vue3 项目</p></div><p>记录从 webpack 迁移到 vite 踩过的坑</p><p>主要完成</p><ul><li>配置 Vue3 官方插件</li><li>添加兼容 CMD 规范及传统浏览器的 vite 官方插件</li><li>添加支持 Vue3 TSX 的官方插件</li><li>配置项目目录别名</li><li>配置组件库的按需加载</li><li>配置组件库的样式覆盖</li></ul><h2 id="第一步" tabindex="-1"><a class="header-anchor" href="#第一步"><span>第一步</span></a></h2><p>将 public 文件夹下的 index.html 移动到根目录下并添加如下代码片段</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/src/main.ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="第二步" tabindex="-1"><a class="header-anchor" href="#第二步"><span>第二步</span></a></h2><p>删除已经不再需要的 vue-cli 相关插件和 vue.config.js 文件</p><ul><li>&quot;@vue/cli-plugin-babel&quot;: &quot;~5.0.0-alpha.2&quot;,</li><li>&quot;@vue/cli-plugin-eslint&quot;: &quot;~5.0.0-alpha.2&quot;,</li><li>&quot;@vue/cli-plugin-router&quot;: &quot;~5.0.0-alpha.2&quot;,</li><li>&quot;@vue/cli-plugin-typescript&quot;: &quot;~5.0.0-alpha.2&quot;,</li><li>&quot;@vue/cli-plugin-vuex&quot;: &quot;~5.0.0-alpha.2&quot;,</li><li>&quot;@vue/cli-service&quot;: &quot;~5.0.0-alpha.2&quot;,</li></ul><p>安装如下插件并添加 vite.config.ts 文件</p><ul><li>&quot;@vitejs/plugin-legacy&quot;: &quot;^1.3.1&quot;, // 兼容 CMD 规范及传统浏览器，类似于 babel</li><li>&quot;@vitejs/plugin-vue&quot;: &quot;^1.1.5&quot;, // Vue3 官方插件</li><li>&quot;@vitejs/plugin-vue-jsx&quot;: &quot;^1.1.2&quot;, // 支持 Vue3 TSX 的官方插件</li></ul><h2 id="第三步" tabindex="-1"><a class="header-anchor" href="#第三步"><span>第三步</span></a></h2><p>配置 vite.config.js</p><div class="language-JavaScript line-numbers-mode" data-ext="JavaScript" data-title="JavaScript"><pre class="language-JavaScript"><code><span class="line">import { resolve } from &quot;path&quot;;</span>
<span class="line">import { defineConfig } from &quot;vite&quot;;</span>
<span class="line">import vue from &quot;@vitejs/plugin-vue&quot;;</span>
<span class="line">import vueJsx from &quot;@vitejs/plugin-vue-jsx&quot;;</span>
<span class="line">import vitePluginImp from &quot;vite-plugin-imp&quot;;</span>
<span class="line">import legacy from &quot;@vitejs/plugin-legacy&quot;;</span>
<span class="line"></span>
<span class="line">export default defineConfig({</span>
<span class="line">  base: &quot;./&quot;,</span>
<span class="line">  resolve: {</span>
<span class="line">    alias: [</span>
<span class="line">      { find: &quot;~&quot;, replacement: resolve(__dirname, &quot;./&quot;) }, // 配置别名</span>
<span class="line">      { find: &quot;@&quot;, replacement: resolve(__dirname, &quot;./src&quot;) },</span>
<span class="line">    ],</span>
<span class="line">  },</span>
<span class="line">  // css加载器相关配置</span>
<span class="line">  css: {</span>
<span class="line">    preprocessorOptions: {</span>
<span class="line">      less: {</span>
<span class="line">        lessOptions: {</span>
<span class="line">          modifyVars: {</span>
<span class="line">            // 通过hack方式覆盖组件库样式</span>
<span class="line">            hack: \`true; @import &quot;./src/assets/style.less&quot;\`,</span>
<span class="line">          },</span>
<span class="line">        },</span>
<span class="line">      },</span>
<span class="line">    },</span>
<span class="line">  },</span>
<span class="line">  plugins: [</span>
<span class="line">    vue(),</span>
<span class="line">    vueJsx(),</span>
<span class="line">    // 利用vitePluginImp配置组件库的按需加载。参考组件库官网</span>
<span class="line">    vitePluginImp({</span>
<span class="line">      libList: [</span>
<span class="line">        {</span>
<span class="line">          libName: &quot;vant&quot;,</span>
<span class="line">          style(name) {</span>
<span class="line">            if (/CompWithoutStyleFile/i.test(name)) {</span>
<span class="line">              // This will not import any style file</span>
<span class="line">              return false;</span>
<span class="line">            }</span>
<span class="line">            return \`vant/es/\${name}/index.css\`;</span>
<span class="line">          },</span>
<span class="line">        },</span>
<span class="line">      ],</span>
<span class="line">    }),</span>
<span class="line">    legacy({</span>
<span class="line">      targets: [&quot;defaults&quot;, &quot;not IE 11&quot;],</span>
<span class="line">    }),</span>
<span class="line">  ],</span>
<span class="line">});</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,15),t=[l];function p(c,u){return n(),a("div",null,t)}const v=s(e,[["render",p],["__file","20210318WebpackToVite.html.vue"]]),d=JSON.parse('{"path":"/blogs/web/20210318WebpackToVite.html","title":"Webpack 迁移到 Vite 笔记","lang":"en-US","frontmatter":{"title":"Webpack 迁移到 Vite 笔记","author":"Rain","tags":["Vue","Webpack","Vite","配置"],"categories":["web"],"date":"2021-03-16 11:06"},"headers":[{"level":2,"title":"第一步","slug":"第一步","link":"#第一步","children":[]},{"level":2,"title":"第二步","slug":"第二步","link":"#第二步","children":[]},{"level":2,"title":"第三步","slug":"第三步","link":"#第三步","children":[]}],"git":{"createdTime":1717432393000,"updatedTime":1717432393000,"contributors":[{"name":"Rain","email":"smalltime153@gmail.com","commits":1}]},"filePathRelative":"blogs/web/20210318WebpackToVite.md"}');export{v as comp,d as data};
